add_namespace = cia

#Welcome to the Game
news_event = {
	id = cia.1
	title = cia.1.t
	desc = cia.1.d
	picture = GFX_report_event_welcome
	is_triggered_only = yes
	option = { #Cool cool
	    name = cia.1.o1		
		ai_chance = { 
		    factor = 100
		}
	}
}

#Baltics reach 100 years of indepentence
news_event = {
	id = cia.2
	title = cia.2.t
	desc = cia.2.d
	picture = GFX_news_event_baltics100
	is_triggered_only = yes
	option = { #Who?
	    name = cia.2.o1
		ai_chance = { 
		    factor = 100
		}
	}
}






add_namespace = unsc

country_event = {
	id = unsc.1
	hidden = yes

	is_triggered_only = yes

	option = {
		save_global_event_target_as = sanctions_country
		set_country_flag = sanctions_country
	}
}

country_event = {
	id = unsc.2
	title = Sanctions
	title = {
		text = "Apply for Trade Sanctions"
		trigger = {
			ROOT = { has_country_flag = apply_for_trade_sanctions }
		}
	}
	desc = {
		text = UNSC_TRADE_SANCTIONS
		trigger = {
			has_country_flag = apply_for_trade_sanctions
		}
	}

	is_triggered_only = yes

	option = {
		name = "Yes"
		custom_effect_tooltip = "UNSC_TRADE_SANCTION_OPTION_TT"
		set_global_flag = UNSC_sanction_voting_ongoing
		event_target:sanctions_country = {
			save_global_event_target_as = sanctions_country_target
		}
		ROOT = {
			save_global_event_target_as = sanctions_country_starter
		}
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = apply_for_trade_sanctions
				}
				start_trade_sanctions_effect = yes
				USA = { country_event = { id = unsc.31 days = 1 } }
			}
		}
	}

	option = {
		name = "No"
		if = {
			limit = {
				ROOT = {
					has_country_flag = apply_for_trade_sanctions
				}
			}
			clr_country_flag = apply_for_trade_sanctions
		}
	}
}

country_event = {
	id = unsc.3
	title = Voting
	title = {
		text = UNSC_TRADE_SANCTIONS_VOTING_TITLE
		trigger = {
			has_global_flag = UNSC_trade_sanctions
		}
	}
	desc = {
		text = UNSC_TRADE_SANCTIONS_VOTING_DESC_PERM
		trigger = {
			has_global_flag = UNSC_trade_sanctions
			has_idea = idea_united_nations_security_council_member
		}
	}
	desc = {
		text = UNSC_TRADE_SANCTIONS_VOTING_DESC_TEMP
		trigger = {
			has_global_flag = UNSC_trade_sanctions
			has_idea = idea_united_nations_NP_security_council_member
		}
	}

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = {
				var = global.UNSC_sanction_days_left
				value = 7
			}
			set_global_flag = UNSC_voting_running
			if = {
				limit = {
					tag = USA
				}
				country_event = { id = unsc.4 days = 8 }
			}
		}
	}

	option = {
		name = "Positive Vote"
		add_to_variable = {
			var = global.UNSC_postive_votes
			value = 1
		}
	}

	option = {
		name = "Veto"
		trigger = {
			has_idea = idea_united_nations_security_council_member
		}
		add_to_variable = {
			var = global.UNSC_vetos
			value = 1
		}
	}

	option = {
		name = "Negative Vote"
		trigger = {
			has_idea = idea_united_nations_NP_security_council_member
		}
		add_to_variable = {
			var = global.UNSC_negative_votes
			value = 1
		}
	}
}

country_event = {
	id = unsc.31
	hidden = yes

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				check_variable = {
					var = global.UNSC_sanction_days_left
					value = 0
					compare = greater_than
				}
			}
			subtract_from_variable = {
				global.UNSC_sanction_days_left = 1
			}
			USA = { country_event = { id = unsc.31 days = 1 } }
			else = {
				break = yes
			}
		}
	}
}

country_event = {
	id = unsc.4
	hidden = yes

	is_triggered_only = yes

	option = {
		clr_global_flag = UNSC_voting_running

		if = {
			limit = {
				OR = {
					check_variable = {
						var = global.UNSC_negative_votes
						value = global.UNSC_positive_votes
						compare = greater_than
					}
					check_variable = {
						var = global.UNSC_vetos
						value = 0
						compare = greater_than
					}
				}
			}
			set_global_flag = UNSC_vote_failed
			every_country = {
				limit = {
					OR = {
						has_idea = idea_united_nations_security_council_member
						has_idea = idea_united_nations_NP_security_council_member
					}
				}
				country_event = unsc.5
			}
		}
		if = {
			limit = {
				AND = {
					check_variable = {
						var = global.UNSC_positive_votes
						value = global.UNSC_negative_votes
						compare = greater_than
					}
					check_variable = {
						var = global.UNSC_vetos
						value = 0
						compare = equals
					}
				}
			}
			set_global_flag = UNSC_vote_successful
			every_country = {
				limit = {
					OR = {
						has_idea = idea_united_nations_security_council_member
						has_idea = idea_united_nations_NP_security_council_member
					}
				}
				country_event = unsc.5
			}
		}
	}
}

country_event = {
	id = unsc.5
	# title = Results
	title = {
		text = UNSC_VOTING_SUCCESSFUL
		trigger = {
			has_global_flag = UNSC_vote_successful
		}
	}
	title = {
		text = UNSC_VOTING_FAILED
		trigger = {
			has_global_flag = UNSC_vote_failed
		}
	}
	desc = {
		text = UNSC_VOTING_SUCCESSFUL_DESC
		trigger = {
			has_global_flag = UNSC_vote_successful
		}
	}
	desc = {
		text = UNSC_VOTING_FAILED_DESC
		trigger = {
			has_global_flag = UNSC_vote_failed
		}
	}

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				has_global_flag = UNSC_vote_successful
				has_global_flag = UNSC_trade_sanctions
				NOT = { has_global_flag = UNSC_trade_sanctions_applied }
			}
			event_target:sanctions_country_target = {
				add_ideas = UNSC_trade_sanctions_idea
			}
			set_global_flag = UNSC_trade_sanctions_applied
		}
		clr_global_flag = UNSC_sanction_voting_ongoing
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_global_flag = UNSC_cleanup }
				}
				set_global_flag = UNSC_cleanup
				USA = { country_event = { id = unsc.6 hours = 2 } }
			}
		}
	}

	option = {
		name = "Okay, Moving on."
	}
}

country_event = {
	id = unsc.6
	hidden = yes

	is_triggered_only = yes

	option = {
		UNSC_cleanup_effect = yes
	}
}